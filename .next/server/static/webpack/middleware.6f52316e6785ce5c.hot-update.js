"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("middleware",{

/***/ "(middleware)/./middleware.ts":
/*!***********************!*\
  !*** ./middleware.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n/* harmony import */ var next_auth_jwt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth/jwt */ \"(middleware)/./node_modules/next-auth/jwt/index.js\");\n/* harmony import */ var next_auth_jwt__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(next_auth_jwt__WEBPACK_IMPORTED_MODULE_1__);\n\n\nconst config = {\n    matcher: [\n        \"/((?!api/|_next/|_static/|_vercel|[\\\\w-]+\\\\.\\\\w+).*)\"\n    ]\n};\nasync function middleware(req) {\n    const url = req.nextUrl;\n    // Get hostname of request\n    let hostname = req.headers.get(\"host\").split(\":\")[0];\n    if (!hostname) return;\n    // Extract the subdomain\n    const subdomain = hostname.split(\".\")[0];\n    // Get the current pathname and search params\n    const path = `${url.pathname}${url.searchParams.toString().length > 0 ? `?${url.searchParams.toString()}` : \"\"}`;\n    // Check for session token\n    const session = await (0,next_auth_jwt__WEBPACK_IMPORTED_MODULE_1__.getToken)({\n        req\n    });\n    console.log(session);\n    // Handle subdomain routing\n    switch(subdomain){\n        case \"admin\":\n        case \"doctor\":\n        case \"patient\":\n        case \"app\":\n            return handleSubdomainRouting(session, path, subdomain, req, url);\n        default:\n            return handleDefaultRouting(session, path, hostname, req);\n    }\n}\nfunction handleSubdomainRouting(session, path, subdomain, req, url) {\n    // Allow access to signin and register pages without session\n    if (!session && (path === \"/auth/signin\" || path === \"/auth/register\")) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    // Redirect to signin if no session and not on signin or register page\n    if (!session) {\n        const callbackUrl = encodeURIComponent(`${url.protocol}//${req.headers.get(\"host\")}${url.pathname}${url.search}`);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.rewrite(new URL(`/auth/signin?callbackUrl=${callbackUrl}`, req.url));\n    }\n    // Redirect to home if session exists and trying to access signin or register page\n    if (session && (path === \"/auth/signin\" || path === \"/auth/register\")) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/\", req.url));\n    }\n    // Rewrite the path for subdomains\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.rewrite(new URL(`/${subdomain}${path}`, req.url));\n}\nfunction handleDefaultRouting(session, path, hostname, req) {\n    // Special case for the root domain or localhost\n    if (hostname === \"127.0.0.1\" || hostname === \"localhost\") {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.rewrite(new URL(`${path}`, req.url));\n    }\n    // Rewrite for other cases\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.rewrite(new URL(`/${hostname}${path}`, req.url));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LElBQUlDLEdBQUc7QUFDcEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbWlkZGxld2FyZS50cz80MjJkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcbmltcG9ydCB7IGdldFRva2VuIH0gZnJvbSBcIm5leHQtYXV0aC9qd3RcIjtcblxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcbiAgbWF0Y2hlcjogW1wiLygoPyFhcGkvfF9uZXh0L3xfc3RhdGljL3xfdmVyY2VsfFtcXFxcdy1dK1xcXFwuXFxcXHcrKS4qKVwiXSxcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIG1pZGRsZXdhcmUocmVxOiBOZXh0UmVxdWVzdCkge1xuICBjb25zdCB1cmwgPSByZXEubmV4dFVybDtcblxuICAvLyBHZXQgaG9zdG5hbWUgb2YgcmVxdWVzdFxuICBsZXQgaG9zdG5hbWUgPSByZXEuaGVhZGVycy5nZXQoXCJob3N0XCIpIS5zcGxpdChcIjpcIilbMF07XG4gIGlmICghaG9zdG5hbWUpIHJldHVybjtcbiAgLy8gRXh0cmFjdCB0aGUgc3ViZG9tYWluXG4gIGNvbnN0IHN1YmRvbWFpbiA9IGhvc3RuYW1lLnNwbGl0KFwiLlwiKVswXTtcblxuICAvLyBHZXQgdGhlIGN1cnJlbnQgcGF0aG5hbWUgYW5kIHNlYXJjaCBwYXJhbXNcbiAgY29uc3QgcGF0aCA9IGAke3VybC5wYXRobmFtZX0ke1xuICAgIHVybC5zZWFyY2hQYXJhbXMudG9TdHJpbmcoKS5sZW5ndGggPiAwXG4gICAgICA/IGA/JHt1cmwuc2VhcmNoUGFyYW1zLnRvU3RyaW5nKCl9YFxuICAgICAgOiBcIlwiXG4gIH1gO1xuXG4gIC8vIENoZWNrIGZvciBzZXNzaW9uIHRva2VuXG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRUb2tlbih7IHJlcSB9KTtcbiAgY29uc29sZS5sb2coc2Vzc2lvbik7XG4gIC8vIEhhbmRsZSBzdWJkb21haW4gcm91dGluZ1xuICBzd2l0Y2ggKHN1YmRvbWFpbikge1xuICAgIGNhc2UgXCJhZG1pblwiOlxuICAgIGNhc2UgXCJkb2N0b3JcIjpcbiAgICBjYXNlIFwicGF0aWVudFwiOlxuICAgIGNhc2UgXCJhcHBcIjpcbiAgICAgIHJldHVybiBoYW5kbGVTdWJkb21haW5Sb3V0aW5nKHNlc3Npb24sIHBhdGgsIHN1YmRvbWFpbiwgcmVxLCB1cmwpO1xuXG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiBoYW5kbGVEZWZhdWx0Um91dGluZyhzZXNzaW9uLCBwYXRoLCBob3N0bmFtZSwgcmVxKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBoYW5kbGVTdWJkb21haW5Sb3V0aW5nKFxuICBzZXNzaW9uOiBhbnksXG4gIHBhdGg6IHN0cmluZyxcbiAgc3ViZG9tYWluOiBzdHJpbmcsXG4gIHJlcTogTmV4dFJlcXVlc3QsXG4gIHVybDogVVJMXG4pIHtcbiAgLy8gQWxsb3cgYWNjZXNzIHRvIHNpZ25pbiBhbmQgcmVnaXN0ZXIgcGFnZXMgd2l0aG91dCBzZXNzaW9uXG4gIGlmICghc2Vzc2lvbiAmJiAocGF0aCA9PT0gXCIvYXV0aC9zaWduaW5cIiB8fCBwYXRoID09PSBcIi9hdXRoL3JlZ2lzdGVyXCIpKSB7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5uZXh0KCk7XG4gIH1cblxuICAvLyBSZWRpcmVjdCB0byBzaWduaW4gaWYgbm8gc2Vzc2lvbiBhbmQgbm90IG9uIHNpZ25pbiBvciByZWdpc3RlciBwYWdlXG4gIGlmICghc2Vzc2lvbikge1xuICAgIGNvbnN0IGNhbGxiYWNrVXJsID0gZW5jb2RlVVJJQ29tcG9uZW50KFxuICAgICAgYCR7dXJsLnByb3RvY29sfS8vJHtyZXEuaGVhZGVycy5nZXQoXCJob3N0XCIpfSR7dXJsLnBhdGhuYW1lfSR7dXJsLnNlYXJjaH1gXG4gICAgKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJld3JpdGUoXG4gICAgICBuZXcgVVJMKGAvYXV0aC9zaWduaW4/Y2FsbGJhY2tVcmw9JHtjYWxsYmFja1VybH1gLCByZXEudXJsKVxuICAgICk7XG4gIH1cblxuICAvLyBSZWRpcmVjdCB0byBob21lIGlmIHNlc3Npb24gZXhpc3RzIGFuZCB0cnlpbmcgdG8gYWNjZXNzIHNpZ25pbiBvciByZWdpc3RlciBwYWdlXG4gIGlmIChzZXNzaW9uICYmIChwYXRoID09PSBcIi9hdXRoL3NpZ25pblwiIHx8IHBhdGggPT09IFwiL2F1dGgvcmVnaXN0ZXJcIikpIHtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoXCIvXCIsIHJlcS51cmwpKTtcbiAgfVxuXG4gIC8vIFJld3JpdGUgdGhlIHBhdGggZm9yIHN1YmRvbWFpbnNcbiAgcmV0dXJuIE5leHRSZXNwb25zZS5yZXdyaXRlKG5ldyBVUkwoYC8ke3N1YmRvbWFpbn0ke3BhdGh9YCwgcmVxLnVybCkpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVEZWZhdWx0Um91dGluZyhcbiAgc2Vzc2lvbjogYW55LFxuICBwYXRoOiBzdHJpbmcsXG4gIGhvc3RuYW1lOiBzdHJpbmcsXG4gIHJlcTogTmV4dFJlcXVlc3Rcbikge1xuICAvLyBTcGVjaWFsIGNhc2UgZm9yIHRoZSByb290IGRvbWFpbiBvciBsb2NhbGhvc3RcbiAgaWYgKFxuICAgIGhvc3RuYW1lID09PSBcIjEyNy4wLjAuMVwiIHx8XG4gICAgaG9zdG5hbWUgPT09IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1JPT1RfRE9NQUlOXG4gICkge1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmV3cml0ZShuZXcgVVJMKGAke3BhdGh9YCwgcmVxLnVybCkpO1xuICB9XG4gIC8vIFJld3JpdGUgZm9yIG90aGVyIGNhc2VzXG4gIHJldHVybiBOZXh0UmVzcG9uc2UucmV3cml0ZShuZXcgVVJMKGAvJHtob3N0bmFtZX0ke3BhdGh9YCwgcmVxLnVybCkpO1xufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImdldFRva2VuIiwiY29uZmlnIiwibWF0Y2hlciIsIm1pZGRsZXdhcmUiLCJyZXEiLCJ1cmwiLCJuZXh0VXJsIiwiaG9zdG5hbWUiLCJoZWFkZXJzIiwiZ2V0Iiwic3BsaXQiLCJzdWJkb21haW4iLCJwYXRoIiwicGF0aG5hbWUiLCJzZWFyY2hQYXJhbXMiLCJ0b1N0cmluZyIsImxlbmd0aCIsInNlc3Npb24iLCJjb25zb2xlIiwibG9nIiwiaGFuZGxlU3ViZG9tYWluUm91dGluZyIsImhhbmRsZURlZmF1bHRSb3V0aW5nIiwibmV4dCIsImNhbGxiYWNrVXJsIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwicHJvdG9jb2wiLCJzZWFyY2giLCJyZXdyaXRlIiwiVVJMIiwicmVkaXJlY3QiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfUk9PVF9ET01BSU4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(middleware)/./middleware.ts\n");

/***/ })

});